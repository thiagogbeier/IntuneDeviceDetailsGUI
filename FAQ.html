<h1 id="intune-device-details-gui-functions-faq">Intune Device Details GUI - Functions FAQ</h1>


<h2 id="table-of-contents">ðŸ“‹ Table of Contents</h2>


<ul>
<li><a href="#overview">Overview</a></li>
</ul>

<ul>
<li><a href="#core-functions">Core Functions</a></li>
</ul>

<ul>
<li><a href="#utility-functions">Utility Functions</a></li>
</ul>

<ul>
<li><a href="#data-retrieval-functions">Data Retrieval Functions</a></li>
</ul>

<ul>
<li><a href="#conversion--parsing-functions">Conversion &amp; Parsing Functions</a></li>
</ul>

<ul>
<li><a href="#report-generation-functions">Report Generation Functions</a></li>
</ul>

<ul>
<li><a href="#frequently-asked-questions">Frequently Asked Questions</a></li>
</ul>


<hr />


<h2 id="overview">Overview</h2>


<p><strong>Q: What is IntuneDeviceDetailsGUI?</strong></p>


<p>A: It's a PowerShell-based tool that generates comprehensive HTML reports for Microsoft Intune managed devices. It provides device intelligence including apps, policies, scripts, assignments, group memberships, and conflict detection.</p>


<p><strong>Q: What version of PowerShell is required?</strong></p>


<p>A: Both Windows PowerShell 5.1 and PowerShell 7.x are supported.</p>


<p><strong>Q: What PowerShell modules are required?</strong></p>


<p>A: Microsoft.Graph.Authentication module is required. The script checks for this automatically and provides installation instructions if missing.</p>


<hr />


<h2 id="core-functions">Core Functions</h2>


<h3 id="invoke-intunedevicedetailsreport"><code>Invoke-IntuneDeviceDetailsReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Main orchestrator function that generates complete device reports.</p>


<p><strong>Parameters:</strong></p>


<ul>
<li><code>DeviceId</code> - Intune device GUID</li>
</ul>

<ul>
<li><code>ReloadCache</code> - Forces cache reload</li>
</ul>

<ul>
<li><code>SkipAssignments</code> - Skips assignment data</li>
</ul>

<ul>
<li><code>DoNotOpenReportAutomatically</code> - Prevents auto-opening report</li>
</ul>

<ul>
<li><code>ExtendedReport</code> - Generates extended report with full details</li>
</ul>


<p><strong>When should I use it?</strong></p>


<p>This is the main entry point for report generation. Call it after finding a device.</p>


<hr />


<h3 id="initialize-intunesession"><code>Initialize-IntuneSession</code></h3>


<p><strong>What does it do?</strong></p>


<p>Establishes connection to Microsoft Graph API and initializes the session.</p>


<p><strong>Key Actions:</strong></p>


<ul>
<li>Checks for required PowerShell modules</li>
</ul>

<ul>
<li>Connects to Microsoft Graph with necessary permissions</li>
</ul>

<ul>
<li>Retrieves tenant information</li>
</ul>

<ul>
<li>Sets up cache folders</li>
</ul>

<ul>
<li>Initializes quick search filters</li>
</ul>


<p><strong>When does it run?</strong></p>


<p>Automatically runs on first API call to ensure authenticated session exists.</p>


<hr />


<h3 id="search-manageddevices"><code>Search-ManagedDevices</code></h3>


<p><strong>What does it do?</strong></p>


<p>Searches for Intune managed devices based on various criteria.</p>


<p><strong>Search Methods:</strong></p>


<ul>
<li>Device name (supports partial matches)</li>
</ul>

<ul>
<li>User principal name (email)</li>
</ul>

<ul>
<li>Serial number</li>
</ul>

<ul>
<li>GUID (exact match)</li>
</ul>

<ul>
<li>Quick filters (predefined queries)</li>
</ul>


<p><strong>Returns:</strong></p>


<p>Array of matching devices with key properties sorted by device name.</p>


<hr />


<h2 id="utility-functions">Utility Functions</h2>


<h3 id="validate-guid"><code>Validate-GUID</code></h3>


<p><strong>What does it do?</strong></p>


<p>Validates if a string is a properly formatted GUID.</p>


<p><strong>Why is it needed?</strong></p>


<p>Determines if search input is a device ID for direct lookup vs. text search.</p>


<hr />


<h3 id="fix-urlspecialcharacters"><code>Fix-UrlSpecialCharacters</code></h3>


<p><strong>What does it do?</strong></p>


<p>URL-encodes special characters for safe Graph API queries.</p>


<p><strong>Characters Encoded:</strong></p>


<ul>
<li>Space â†’ %20</li>
</ul>

<ul>
<li>Quote â†’ %22</li>
</ul>

<ul>
<li>Apostrophe â†’ %27</li>
</ul>

<ul>
<li>Backslash â†’ %5C</li>
</ul>

<ul>
<li>@ â†’ %40</li>
</ul>

<ul>
<li>Nordic characters (Ã¤, Ã¶, Ã¥, Ã„, Ã–, Ã…)</li>
</ul>


<p><strong>Why is it important?</strong></p>


<p>Prevents API errors when searching for devices with special characters in names.</p>


<hr />


<h3 id="add-guidtohashtable"><code>Add-GUIDToHashtable</code></h3>


<p><strong>What does it do?</strong></p>


<p>Adds object GUIDs to a global hashtable for fast lookups.</p>


<p><strong>Why use a hashtable?</strong></p>


<p>O(1) lookup performance vs. O(n) array searches when resolving GUIDs to names.</p>


<hr />


<h3 id="get-namefromguid"><code>Get-NameFromGUID</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves display name for a GUID from the hashtable.</p>


<p><strong>Use Case:</strong></p>


<p>Converting policy/group/user GUIDs to readable names in reports.</p>


<hr />


<h3 id="get-objectfromguid"><code>Get-ObjectFromGUID</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves complete object data for a GUID from hashtable.</p>


<p><strong>Use Case:</strong></p>


<p>Getting full object details when you only have the GUID.</p>


<hr />


<h3 id="convertto-localdatetimestring"><code>ConvertTo-LocalDateTimeString</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts UTC datetime strings to local timezone with custom formatting.</p>


<p><strong>Format:</strong></p>


<p><code>yyyy-MM-dd HH:mm:ss</code> (e.g., &quot;2026-01-16 14:30:45&quot;)</p>


<hr />


<h3 id="get-cachefolder"><code>Get-CacheFolder</code></h3>


<p><strong>What does it do?</strong></p>


<p>Returns the cache folder path for the current tenant.</p>


<p><strong>Cache Structure:</strong></p>


<p><code>cache\{TenantId}\</code> stores downloaded data to minimize API calls.</p>


<hr />


<h3 id="ensure-directory"><code>Ensure-Directory</code></h3>


<p><strong>What does it do?</strong></p>


<p>Creates directory if it doesn't exist and returns the path.</p>


<p><strong>When is it used?</strong></p>


<p>Setting up cache and reports folders.</p>


<hr />


<h2 id="data-retrieval-functions">Data Retrieval Functions</h2>


<h3 id="invoke-mggraphgetrequestwithmsgraphallpages"><code>Invoke-MGGraphGetRequestWithMSGraphAllPages</code></h3>


<p><strong>What does it do?</strong></p>


<p>Executes Graph API GET requests with automatic pagination handling.</p>


<p><strong>Why is pagination needed?</strong></p>


<p>Graph API returns max 100-1000 items per request. This function automatically follows @odata.nextLink to get all results.</p>


<p><strong>Parameters:</strong></p>


<ul>
<li><code>url</code> - Graph API endpoint URL</li>
</ul>


<hr />


<h3 id="invoke-mggraphpostrequest"><code>Invoke-MGGraphPostRequest</code></h3>


<p><strong>What does it do?</strong></p>


<p>Executes Graph API POST requests (used for reporting endpoints).</p>


<p><strong>Use Cases:</strong></p>


<ul>
<li>Configuration policy reports</li>
</ul>

<ul>
<li>Compliance policy reports</li>
</ul>

<ul>
<li>App installation reports</li>
</ul>


<hr />


<h3 id="get-manageddevicesnapshot"><code>Get-ManagedDeviceSnapshot</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves current device data from Intune.</p>


<p><strong>Data Includes:</strong></p>


<ul>
<li>Device name, OS, manufacturer, model</li>
</ul>

<ul>
<li>Enrollment date, last sync</li>
</ul>

<ul>
<li>Compliance state</li>
</ul>

<ul>
<li>Primary user</li>
</ul>

<ul>
<li>Serial number</li>
</ul>


<hr />


<h3 id="get-additionaldevicehardware"><code>Get-AdditionalDeviceHardware</code></h3>


<p><strong>What does it do?</strong></p>


<p>Fetches extended hardware information.</p>


<p><strong>Additional Data:</strong></p>


<ul>
<li>Total storage, free storage</li>
</ul>

<ul>
<li>Physical memory</li>
</ul>

<ul>
<li>Device category</li>
</ul>

<ul>
<li>Ownership type</li>
</ul>


<hr />


<h3 id="get-primaryusercontext"><code>Get-PrimaryUserContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves primary user and their Azure AD group memberships.</p>


<p><strong>Why is this important?</strong></p>


<p>Determines which user-targeted assignments apply to the device.</p>


<hr />


<h3 id="get-latestlogoncontext"><code>Get-LatestLogonContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Finds the most recent logged-in user and their group memberships.</p>


<p><strong>Use Case:</strong></p>


<p>Device may be assigned to one user but another user recently logged in. Both contexts matter for assignments.</p>


<hr />


<h3 id="get-azuredevicecontext"><code>Get-AzureDeviceContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves Azure AD device object and device group memberships.</p>


<p><strong>Why separate from Intune?</strong></p>


<p>Azure AD device has additional properties and group memberships critical for assignments.</p>


<hr />


<h3 id="get-autopilotcontext"><code>Get-AutopilotContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves Windows Autopilot device registration and assigned profile.</p>


<p><strong>Data Includes:</strong></p>


<ul>
<li>Autopilot profile assignments</li>
</ul>

<ul>
<li>Group tags</li>
</ul>

<ul>
<li>Purchase order ID</li>
</ul>

<ul>
<li>Deployment profile settings</li>
</ul>


<hr />


<h3 id="get-autopilotdevicepreparationcontext"><code>Get-AutopilotDevicePreparationContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves Autopilot Device Preparation profile for newer enrollment type.</p>


<p><strong>When is it used?</strong></p>


<p>For devices using Windows Autopilot Device Preparation instead of traditional Autopilot.</p>


<hr />


<h3 id="get-enrollmentstatuspagecontext"><code>Get-EnrollmentStatusPageContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves Enrollment Status Page (ESP) profile assigned to device.</p>


<p><strong>ESP Controls:</strong></p>


<ul>
<li>Which apps/policies must install during OOBE</li>
</ul>

<ul>
<li>Timeout settings</li>
</ul>

<ul>
<li>User permissions during enrollment</li>
</ul>


<hr />


<h3 id="get-securitycontext"><code>Get-SecurityContext</code></h3>


<p><strong>What does it do?</strong></p>


<p>Previously retrieved BitLocker keys and Windows LAPS passwords (now commented out for security).</p>


<p><strong>Why removed from main flow?</strong></p>


<p>Sensitive data that requires explicit user consent and additional permissions.</p>


<hr />


<h3 id="get-applicationswithassignments"><code>Get-ApplicationsWithAssignments</code></h3>


<p><strong>What does it do?</strong></p>


<p>Downloads all Intune applications with their assignment data.</p>


<p><strong>Cached:</strong></p>


<p>Yes - cached for 24 hours to improve performance.</p>


<p><strong>Includes:</strong></p>


<ul>
<li>Win32 apps</li>
</ul>

<ul>
<li>Store apps</li>
</ul>

<ul>
<li>iOS/macOS apps</li>
</ul>

<ul>
<li>Web apps</li>
</ul>

<ul>
<li>Assignment groups and filters</li>
</ul>


<hr />


<h3 id="get-mobileappassignments"><code>Get-MobileAppAssignments</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves and processes app assignments for specific application.</p>


<p><strong>Assignment Types:</strong></p>


<ul>
<li>Required</li>
</ul>

<ul>
<li>Available</li>
</ul>

<ul>
<li>Uninstall</li>
</ul>

<ul>
<li>Device vs. User context</li>
</ul>


<hr />


<h3 id="get-remediationscriptswithassignments"><code>Get-RemediationScriptsWithAssignments</code></h3>


<p><strong>What does it do?</strong></p>


<p>Downloads all Proactive Remediation scripts with assignments.</p>


<p><strong>Data Includes:</strong></p>


<ul>
<li>Detection script</li>
</ul>

<ul>
<li>Remediation script</li>
</ul>

<ul>
<li>Run schedule</li>
</ul>

<ul>
<li>Assignment groups</li>
</ul>


<hr />


<h3 id="get-platformscriptswithassignments"><code>Get-PlatformScriptsWithAssignments</code></h3>


<p><strong>What does it do?</strong></p>


<p>Downloads PowerShell and Shell scripts with assignments.</p>


<p><strong>Platforms:</strong></p>


<ul>
<li>Windows (PowerShell)</li>
</ul>

<ul>
<li>macOS (Shell scripts)</li>
</ul>


<hr />


<h3 id="get-powershellscriptcontent"><code>Get-PowerShellScriptContent</code></h3>


<p><strong>What does it do?</strong></p>


<p>Decodes and retrieves Base64-encoded PowerShell script content.</p>


<hr />


<h3 id="get-macosshellscriptcontent"><code>Get-MacOSShellScriptContent</code></h3>


<p><strong>What does it do?</strong></p>


<p>Decodes and retrieves Base64-encoded macOS shell script content.</p>


<hr />


<h3 id="get-remediationdetectionscriptcontent"><code>Get-RemediationDetectionScriptContent</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves detection script content from remediation.</p>


<hr />


<h3 id="get-remediationremediatescriptcontent"><code>Get-RemediationRemediateScriptContent</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves remediation script content from remediation.</p>


<hr />


<h3 id="download-intunefilters"><code>Download-IntuneFilters</code></h3>


<p><strong>What does it do?</strong></p>


<p>Downloads all assignment filters configured in Intune.</p>


<p><strong>Cached:</strong></p>


<p>Yes - filters are cached to improve performance.</p>


<p><strong>Why important?</strong></p>


<p>Filters determine whether assignments apply to specific devices based on device properties.</p>


<hr />


<h3 id="download-intuneconfigurationprofiles2"><code>Download-IntuneConfigurationProfiles2</code></h3>


<p><strong>What does it do?</strong></p>


<p>Downloads all configuration profiles including:</p>


<ul>
<li>Device Configuration policies</li>
</ul>

<ul>
<li>Settings Catalog policies</li>
</ul>

<ul>
<li>Administrative Templates</li>
</ul>

<ul>
<li>Compliance policies</li>
</ul>


<p><strong>Cached:</strong></p>


<p>Yes - cached for 24 hours.</p>


<hr />


<h3 id="download-intuneposttypereport"><code>Download-IntunePostTypeReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Generic function for downloading POST-based Intune reports.</p>


<p><strong>Use Cases:</strong></p>


<ul>
<li>Configuration policy device status</li>
</ul>

<ul>
<li>App installation status</li>
</ul>

<ul>
<li>Compliance reports</li>
</ul>


<hr />


<h3 id="get-configurationpolicyreport"><code>Get-ConfigurationPolicyReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Generates device-specific configuration policy status report.</p>


<p><strong>Reports Include:</strong></p>


<ul>
<li>Applied policies</li>
</ul>

<ul>
<li>Policy settings</li>
</ul>

<ul>
<li>Success/failure status</li>
</ul>

<ul>
<li>Error messages</li>
</ul>

<ul>
<li>Conflict detection</li>
</ul>


<p><strong>This is a large function (500+ lines). What does it contain?</strong></p>


<p>Complex logic to:</p>


<ol>
<li>Query all policy types</li>
</ol>

<ol start="2">
<li>Match assignments to device/user</li>
</ol>

<ol start="3">
<li>Retrieve policy settings</li>
</ol>

<ol start="4">
<li>Detect conflicts</li>
</ol>

<ol start="5">
<li>Format results for HTML</li>
</ol>


<hr />


<h3 id="get-remediationscriptsreport"><code>Get-RemediationScriptsReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Generates remediation script status report for device.</p>


<p><strong>Status Includes:</strong></p>


<ul>
<li>Detection results</li>
</ul>

<ul>
<li>Remediation results</li>
</ul>

<ul>
<li>Execution timestamps</li>
</ul>

<ul>
<li>Success/failure states</li>
</ul>

<ul>
<li>Pre/post remediation detection results</li>
</ul>


<hr />


<h3 id="get-appleenrollmentprofiledetails"><code>Get-AppleEnrollmentProfileDetails</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves iOS/macOS enrollment profile assignments.</p>


<p><strong>Includes:</strong></p>


<ul>
<li>DEP profiles</li>
</ul>

<ul>
<li>Profile restrictions</li>
</ul>

<ul>
<li>Setup assistant options</li>
</ul>


<hr />


<h3 id="get-settingscatalogpolicydetails"><code>Get-SettingsCatalogPolicyDetails</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves detailed settings for Settings Catalog policies.</p>


<p><strong>Why complex?</strong></p>


<p>Settings Catalog uses dynamic schema requiring additional API calls to get setting definitions.</p>


<hr />


<h3 id="analyze-settingscatalogconflicts"><code>Analyze-SettingsCatalogConflicts</code></h3>


<p><strong>What does it do?</strong></p>


<p>Detects and reports conflicting settings across multiple Settings Catalog policies.</p>


<p><strong>Conflict Detection:</strong></p>


<ul>
<li>Same setting in multiple policies with different values</li>
</ul>

<ul>
<li>Groups conflicts by setting instance path</li>
</ul>

<ul>
<li>Shows policy priority and values</li>
</ul>


<hr />


<h3 id="get-checkedinusersinfo"><code>Get-CheckedInUsersInfo</code></h3>


<p><strong>What does it do?</strong></p>


<p>Retrieves information about users who have logged into the device.</p>


<p><strong>Data Source:</strong></p>


<p><code>usersLoggedOn</code> property from Intune device object.</p>


<hr />


<h2 id="conversion-parsing-functions">Conversion &amp; Parsing Functions</h2>


<h3 id="convertto-readablesettingscatalog"><code>ConvertTo-ReadableSettingsCatalog</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts Settings Catalog raw JSON to human-readable format.</p>


<p><strong>Transformation:</strong></p>


<ul>
<li>Resolves setting definitions</li>
</ul>

<ul>
<li>Formats nested structures</li>
</ul>

<ul>
<li>Displays setting paths and values</li>
</ul>


<hr />


<h3 id="parse-settinginstance"><code>Parse-SettingInstance</code></h3>


<p><strong>What does it do?</strong></p>


<p>Parses individual setting instances from Settings Catalog.</p>


<p><strong>Handles:</strong></p>


<ul>
<li>Simple settings</li>
</ul>

<ul>
<li>Choice settings</li>
</ul>

<ul>
<li>Group settings (nested)</li>
</ul>

<ul>
<li>Collection settings (arrays)</li>
</ul>


<hr />


<h3 id="extract-settinginfo"><code>Extract-SettingInfo</code></h3>


<p><strong>What does it do?</strong></p>


<p>Extracts setting definition information from catalog schema.</p>


<hr />


<h3 id="convertto-readableomasettings"><code>ConvertTo-ReadableOmaSettings</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts OMA-URI custom settings to readable format.</p>


<p><strong>OMA-URI Used In:</strong></p>


<ul>
<li>Custom device configuration</li>
</ul>

<ul>
<li>Administrative templates</li>
</ul>

<ul>
<li>Legacy CSP settings</li>
</ul>


<hr />


<h3 id="get-omasettingplaintextvalue"><code>Get-OmaSettingPlainTextValue</code></h3>


<p><strong>What does it do?</strong></p>


<p>Decodes Base64-encoded OMA-URI setting values.</p>


<hr />


<h3 id="convertto-readablewin32lobapp"><code>ConvertTo-ReadableWin32LobApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts Win32 app definitions to readable format with all properties.</p>


<p><strong>Includes:</strong></p>


<ul>
<li>Installation commands</li>
</ul>

<ul>
<li>Detection rules</li>
</ul>

<ul>
<li>Requirements</li>
</ul>

<ul>
<li>Return codes</li>
</ul>

<ul>
<li>Dependencies and supersedence</li>
</ul>


<p><strong>This is the largest conversion function (500+ lines). Why so large?</strong></p>


<p>Win32 apps have extensive configuration:</p>


<ul>
<li>Multiple detection rule types</li>
</ul>

<ul>
<li>Complex requirement rules</li>
</ul>

<ul>
<li>Custom return codes</li>
</ul>

<ul>
<li>Dependencies/supersedence chains</li>
</ul>

<ul>
<li>Installation/uninstallation commands</li>
</ul>


<hr />


<h3 id="convertto-readablemacosdmgapp"><code>ConvertTo-ReadableMacOSDmgApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts macOS DMG app packages to readable format.</p>


<hr />


<h3 id="convertto-readablemacospkgapp"><code>ConvertTo-ReadableMacOSPkgApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts macOS PKG installers to readable format.</p>


<hr />


<h3 id="convertto-readableiosvppapp"><code>ConvertTo-ReadableIosVppApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts iOS VPP (Volume Purchase Program) apps to readable format.</p>


<hr />


<h3 id="convertto-readablemacosvppapp"><code>ConvertTo-ReadableMacOsVppApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts macOS VPP apps to readable format.</p>


<hr />


<h3 id="convertto-readablewebapp"><code>ConvertTo-ReadableWebApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts web link apps to readable format.</p>


<hr />


<h3 id="convertto-readablewingetapp"><code>ConvertTo-ReadableWinGetApp</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts Windows Package Manager (WinGet) apps to readable format.</p>


<hr />


<h3 id="convertto-readablemacoscustomconfiguration"><code>ConvertTo-ReadableMacOSCustomConfiguration</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts macOS custom configuration profiles to readable format.</p>


<hr />


<h3 id="convertto-readablemacoscustomappconfiguration"><code>ConvertTo-ReadableMacOSCustomAppConfiguration</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts macOS app-specific configuration to readable format.</p>


<hr />


<h3 id="convertto-readableappleenrollmentprofile"><code>ConvertTo-ReadableAppleEnrollmentProfile</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts Apple DEP enrollment profiles to readable format.</p>


<hr />


<h3 id="objectify_json_schema_and_data_to_powershellobjects"><code>Objectify_JSON_Schema_and_Data_To_PowershellObjects</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts JSON schema and data into PowerShell objects for reporting.</p>


<p><strong>Use Case:</strong></p>


<p>Processing Intune's complex JSON reports into structured objects.</p>


<hr />


<h2 id="report-generation-functions">Report Generation Functions</h2>


<h3 id="new-intunedevicehtmlreport"><code>New-IntuneDeviceHtmlReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Generates the complete HTML report with all device data.</p>


<p><strong>Report Sections:</strong></p>


<ol>
<li>Device Summary</li>
</ol>

<ol start="2">
<li>User Information</li>
</ol>

<ol start="3">
<li>Azure AD Device Info</li>
</ol>

<ol start="4">
<li>Autopilot Information</li>
</ol>

<ol start="5">
<li>Group Memberships</li>
</ol>

<ol start="6">
<li>Applications (with status)</li>
</ol>

<ol start="7">
<li>Configuration Policies (with settings)</li>
</ol>

<ol start="8">
<li>Compliance Policies</li>
</ol>

<ol start="9">
<li>Scripts</li>
</ol>

<ol start="10">
<li>Remediation Scripts</li>
</ol>

<ol start="11">
<li>Conflicts</li>
</ol>

<ol start="12">
<li>Raw JSON Data (Extended Report only)</li>
</ol>


<p><strong>This is the largest function (2000+ lines). What's in it?</strong></p>


<ul>
<li>HTML structure generation</li>
</ul>

<ul>
<li>CSS styling (embedded)</li>
</ul>

<ul>
<li>JavaScript for interactive features</li>
</ul>

<ul>
<li>Data formatting for all sections</li>
</ul>

<ul>
<li>Conditional rendering based on report type</li>
</ul>

<ul>
<li>Conflict highlighting</li>
</ul>

<ul>
<li>Status badges and icons</li>
</ul>


<hr />


<h3 id="save-intunedevicehtmlreport"><code>Save-IntuneDeviceHtmlReport</code></h3>


<p><strong>What does it do?</strong></p>


<p>Saves the generated HTML report to disk and optionally opens it.</p>


<p><strong>Filename Format:</strong></p>


<p><code>IntuneDeviceReport_{DeviceName}_{Timestamp}.html</code></p>


<hr />


<h3 id="write-devicesummarytoconsole"><code>Write-DeviceSummaryToConsole</code></h3>


<p><strong>What does it do?</strong></p>


<p>Displays device summary in console with colored output.</p>


<hr />


<h3 id="write-devicesearchtable"><code>Write-DeviceSearchTable</code></h3>


<p><strong>What does it do?</strong></p>


<p>Formats and displays device search results in console table.</p>


<hr />


<h3 id="invoke-interactivedeviceselection"><code>Invoke-InteractiveDeviceSelection</code></h3>


<p><strong>What does it do?</strong></p>


<p>Handles interactive device selection from search results.</p>


<p><strong>Features:</strong></p>


<ul>
<li>Numbered device list</li>
</ul>

<ul>
<li>Last sync age highlighting</li>
</ul>

<ul>
<li>Quick filter shortcuts</li>
</ul>

<ul>
<li>Quit option</li>
</ul>


<hr />


<h3 id="resolve-deviceid"><code>Resolve-DeviceId</code></h3>


<p><strong>What does it do?</strong></p>


<p>Resolves various device identifier inputs to Intune device GUID.</p>


<p><strong>Accepts:</strong></p>


<ul>
<li>Intune device GUID</li>
</ul>

<ul>
<li>Device name</li>
</ul>

<ul>
<li>User email</li>
</ul>

<ul>
<li>Serial number</li>
</ul>


<hr />


<h3 id="update-quickfilters"><code>Update-QuickFilters</code></h3>


<p><strong>What does it do?</strong></p>


<p>Generates dynamic quick filter list for device searches.</p>


<p><strong>Filter Categories:</strong></p>


<ul>
<li>Last sync time (1, 3, 7, 14, 30 days)</li>
</ul>

<ul>
<li>Operating System (Windows, iOS, Android, macOS)</li>
</ul>

<ul>
<li>Enrollment age (7, 30 days)</li>
</ul>

<ul>
<li>Compliance state</li>
</ul>

<ul>
<li>Ownership type (Corporate/Personal)</li>
</ul>


<hr />


<h3 id="resolve-assignmentgroupnames"><code>Resolve-AssignmentGroupNames</code></h3>


<p><strong>What does it do?</strong></p>


<p>Converts assignment group GUIDs to display names.</p>


<p><strong>Handles:</strong></p>


<ul>
<li>Include/Exclude groups</li>
</ul>

<ul>
<li>All Users/All Devices virtual groups</li>
</ul>

<ul>
<li>Filter assignments</li>
</ul>


<hr />


<h3 id="resolve-espassignmentgroupnames"><code>Resolve-EspAssignmentGroupNames</code></h3>


<p><strong>What does it do?</strong></p>


<p>Specialized version for ESP profile assignment group resolution.</p>


<hr />


<h3 id="add-azureadgroupgrouptypeextraproperties"><code>Add-AzureADGroupGroupTypeExtraProperties</code></h3>


<p><strong>What does it do?</strong></p>


<p>Adds formatted group type properties to Azure AD groups.</p>


<p><strong>Properties Added:</strong></p>


<ul>
<li>Group type (Security/Microsoft 365)</li>
</ul>

<ul>
<li>Membership type (Assigned/Dynamic)</li>
</ul>

<ul>
<li>Formatted display strings</li>
</ul>


<hr />


<h3 id="add-azureadgroupdevicesandusermembercountextraproperties"><code>Add-AzureADGroupDevicesAndUserMemberCountExtraProperties</code></h3>


<p><strong>What does it do?</strong></p>


<p>Adds device and user member counts to group objects.</p>


<p><strong>Cached:</strong></p>


<p>Yes - member counts cached to reduce API calls.</p>


<hr />


<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>


<h3 id="general-usage">General Usage</h3>


<p><strong>Q: How do I run the script?</strong></p>


<p>A: <code>.\IntuneDeviceDetailsGUI.ps1</code> for interactive mode, or use parameters for direct report generation.</p>


<p><strong>Q: Do I need admin rights?</strong></p>


<p>A: No, but you need appropriate Intune/Azure AD permissions (read permissions for devices, apps, policies).</p>


<p><strong>Q: How long does report generation take?</strong></p>


<p>A: First run: 2-5 minutes (downloads all data). Subsequent runs: 30-60 seconds (uses cache).</p>


<p><strong>Q: Can I generate reports for multiple devices?</strong></p>


<p>A: Yes, use pipeline: <code>Get-IntuneManagedDevice | Where-Object {$_.deviceName -like 'LAPTOP*'} | .\IntuneDeviceDetailsGUI.ps1 -Id $_.id</code></p>


<hr />


<h3 id="caching">Caching</h3>


<p><strong>Q: Where is data cached?</strong></p>


<p>A: <code>cache\{TenantId}\</code> folder in script directory.</p>


<p><strong>Q: How long is cache valid?</strong></p>


<p>A: 24 hours by default (configurable via <code>$script:ReloadCacheEveryNDays</code>).</p>


<p><strong>Q: How do I force cache refresh?</strong></p>


<p>A: Use <code>-ReloadCache</code> parameter.</p>


<p><strong>Q: What's cached?</strong></p>


<p>A: Applications, configuration profiles, scripts, remediation scripts, filters, group details.</p>


<p><strong>Q: What's NOT cached?</strong></p>


<p>A: Individual device data (always fetched fresh).</p>


<hr />


<h3 id="reports">Reports</h3>


<p><strong>Q: What's the difference between standard and extended reports?</strong></p>


<p>A:</p>


<ul>
<li><strong>Standard</strong>: Device info, apps, policies, scripts, assignments, conflicts</li>
</ul>

<ul>
<li><strong>Extended</strong>: Everything above PLUS policy settings details, script contents, full JSON data</li>
</ul>


<p><strong>Q: Where are reports saved?</strong></p>


<p>A: <code>reports\</code> folder by default, or custom location with <code>-OutputFolder</code>.</p>


<p><strong>Q: Can I customize the report?</strong></p>


<p>A: Yes, modify the <code>New-IntuneDeviceHtmlReport</code> function HTML/CSS sections.</p>


<p><strong>Q: Does the report contain sensitive data?</strong></p>


<p>A: No BitLocker keys or LAPS passwords by default. Script contents are included in extended reports.</p>


<hr />


<h3 id="performance">Performance</h3>


<p><strong>Q: The script is slow on first run. Why?</strong></p>


<p>A: It downloads all apps, policies, and scripts from your tenant. This data is cached for subsequent runs.</p>


<p><strong>Q: How can I speed up reports?</strong></p>


<p>A: Use <code>-SkipAssignments</code> for minimal reports, or ensure cache is recent.</p>


<p><strong>Q: How many API calls does it make?</strong></p>


<p>A: First run: 50-200+ calls depending on tenant size. Cached runs: 10-20 calls.</p>


<hr />


<h3 id="troubleshooting">Troubleshooting</h3>


<p><strong>Q: I get &quot;Cannot bind argument to parameter 'Url' because it is an empty string&quot;</strong></p>


<p>A: This was fixed in recent versions. Update to latest version or ensure you don't press Enter with empty search.</p>


<p><strong>Q: Authentication fails. What should I do?</strong></p>


<p>A: Run <code>Disconnect-MgGraph</code> then rerun script. Ensure you have required permissions.</p>


<p><strong>Q: Some policies show as &quot;not assigned&quot; but they are. Why?</strong></p>


<p>A: Check if filters are used - they may be excluding the device. Also verify group membership sync.</p>


<p><strong>Q: Conflict detection shows no conflicts but I see conflicting policies. Why?</strong></p>


<p>A: Conflict detection only works for Settings Catalog policies. OMA-URI and legacy profiles require manual review.</p>


<hr />


<h3 id="advanced-usage">Advanced Usage</h3>


<p><strong>Q: Can I use this in automation?</strong></p>


<p>A: Yes, use <code>-Id</code> parameter with device GUID and <code>-DoNotOpenReportAutomatically</code>.</p>


<p><strong>Q: Can I export to formats other than HTML?</strong></p>


<p>A: No built-in support, but you can modify the script to export JSON objects.</p>


<p><strong>Q: Can I query multiple tenants?</strong></p>


<p>A: Yes, disconnect and reconnect between tenants. Each tenant has separate cache.</p>


<p><strong>Q: How do I integrate with Azure Automation?</strong></p>


<p>A: Use Managed Identity authentication (requires code modifications for non-interactive auth).</p>


<hr />


<h3 id="security-compliance">Security &amp; Compliance</h3>


<p><strong>Q: Are credentials stored?</strong></p>


<p>A: No, uses Microsoft Graph SDK which stores tokens securely via Windows Credential Manager.</p>


<p><strong>Q: What permissions are required?</strong></p>


<p>A:</p>


<ul>
<li>DeviceManagementManagedDevices.Read.All</li>
</ul>

<ul>
<li>DeviceManagementApps.Read.All</li>
</ul>

<ul>
<li>DeviceManagementConfiguration.Read.All</li>
</ul>

<ul>
<li>DeviceManagementServiceConfig.Read.All</li>
</ul>

<ul>
<li>DeviceManagementScripts.Read.All</li>
</ul>

<ul>
<li>User.Read.All</li>
</ul>

<ul>
<li>Group.Read.All</li>
</ul>

<ul>
<li>GroupMember.Read.All</li>
</ul>

<ul>
<li>Directory.Read.All</li>
</ul>


<p><strong>Q: Can I run this with least privilege?</strong></p>


<p>A: Yes, all permissions are read-only. No write operations are performed.</p>


<p><strong>Q: Is the HTML report safe to share?</strong></p>


<p>A: Review contents first. It contains device info, user names, group memberships, and policy details. Redact sensitive data before sharing externally.</p>


<hr />


<h2 id="version-information">Version Information</h2>


<p><strong>Current Version:</strong> 4.0</p>


<p><strong>Author:</strong> Petri Paavola</p>


<p><strong>Repository:</strong> <a href="https://github.com/petripaavola/IntuneDeviceDetailsGUI">https://github.com/petripaavola/IntuneDeviceDetailsGUI</a></p>


<hr />


<h2 id="quick-reference-common-use-cases">Quick Reference: Common Use Cases</h2>


<h3 id="use-case-1-find-and-report-on-a-device-by-name">Use Case 1: Find and report on a device by name</h3>


<pre><code class="language-powershell"></code></pre>

<p>.\IntuneDeviceDetailsGUI.ps1 -SearchText &quot;LAPTOP001&quot;</p>

<pre><code></code></pre>


<h3 id="use-case-2-generate-extended-report-for-specific-device">Use Case 2: Generate extended report for specific device</h3>


<pre><code class="language-powershell"></code></pre>

<p>.\IntuneDeviceDetailsGUI.ps1 -Id &quot;2e6e1d5f-b18a-44c6-989e-9bbb1efafbff&quot; -ExtendedReport</p>

<pre><code></code></pre>


<h3 id="use-case-3-quick-minimal-report-no-assignments">Use Case 3: Quick minimal report (no assignments)</h3>


<pre><code class="language-powershell"></code></pre>

<p>.\IntuneDeviceDetailsGUI.ps1 -Id &quot;2e6e1d5f-b18a-44c6-989e-9bbb1efafbff&quot; -SkipAssignments</p>

<pre><code></code></pre>


<h3 id="use-case-4-batch-reporting-via-pipeline">Use Case 4: Batch reporting via pipeline</h3>


<pre><code class="language-powershell"></code></pre>

<p>Get-Content deviceids.txt | ForEach-Object {</p>

<pre><code>.\IntuneDeviceDetailsGUI.ps1 -Id $_ -DoNotOpenReportAutomatically
</code></pre>

<p>}</p>

<pre><code></code></pre>


<h3 id="use-case-5-force-fresh-data">Use Case 5: Force fresh data</h3>


<pre><code class="language-powershell"></code></pre>

<p>.\IntuneDeviceDetailsGUI.ps1 -ReloadCache</p>

<pre><code></code></pre>


<hr />


<h2 id="function-categories-summary">Function Categories Summary</h2>


<p>| Category             | Count  | Purpose                               |</p>

<p>| -------------------- | ------ | ------------------------------------- |</p>

<p>| Core Functions       | 3      | Main orchestration and initialization |</p>

<p>| Utility Functions    | 9      | Helper functions for common tasks     |</p>

<p>| Data Retrieval       | 20     | Fetch data from Microsoft Graph API   |</p>

<p>| Conversion &amp; Parsing | 17     | Transform API data to readable format |</p>

<p>| Report Generation    | 12     | Create and format HTML reports        |</p>

<p>| <strong>Total</strong>            | <strong>61</strong> | <strong>Complete device intelligence</strong>      |</p>


<hr />


<h2 id="support-contributions">Support &amp; Contributions</h2>


<p>For issues, feature requests, or contributions, visit the GitHub repository.</p>


<p><strong>Need help?</strong> Check the troubleshooting section or open an issue on GitHub.</p>

